mutate(percentage = n()/sum(fatalities$n)*100)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n/cumsum(n)*100)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/sum(n))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/sum(n))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/summarise(sum(n)))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/summarise(sum))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/colSums(n))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/summarise(n))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/n)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/sum(n))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/(summarise(sum(n))) %>% ungroup()))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/(summarise(sum(n))) %>% ungroup())
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/(summarise(sum(n))))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/count(younger))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/ (younger %>% count()))
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/(1905+553+77))
esquisse:::esquisser()
esquisse:::esquisser()
library(tidyverse)
hh_income <- read.csv("Median_Household_Income_2015.csv")
pct_poverty<- read.csv("Pct_People_Below_Poverty_Level.csv")
pct_completed_hs <- read.csv("Pct_Over_25_Completed_High_School.csv")
share_race_city <- read.csv("Share_of_Race_By_City.csv")
fatalities <- read.csv("Deaths_by_Police_US.csv")
dim(share_race_city)
dim(fatalities)
dim(hh_income)
dim(pct_completed_hs)
dim(pct_poverty)
colnames(share_race_city)
colnames(fatalities)
colnames(hh_income)
colnames(pct_completed_hs)
colnames(pct_poverty)
any(is.na(fatalities))
any(is.na(hh_income))
any(is.na(pct_completed_hs))
any(is.na(pct_poverty))
any(is.na(share_race_city))
pct_poverty$poverty_rate <- as.numeric(pct_poverty$poverty_rate)
pct_poverty %>% drop_na() %>% head()
poverty_state <- pct_poverty %>%
drop_na() %>%
group_by(Geographic.Area) %>%
summarise(avg = mean((poverty_rate))) %>%
arrange(desc(avg))
ggplot(poverty_state, aes(x = reorder(Geographic.Area, avg), y = avg)) +
geom_col()  + theme_minimal()
pct_completed_hs$percent_completed_hs <- as.numeric(pct_completed_hs$percent_completed_hs)
hs_completed <- pct_completed_hs %>%
drop_na() %>%
group_by(Geographic.Area) %>%
summarise(avg = mean((percent_completed_hs))) %>%
arrange(desc(avg))
hs_completed
ggplot() +
geom_line(
data = hs_completed,
aes(x = Geographic.Area, y = avg),
group = 1,
color = "pink"
) +
geom_point(data = hs_completed,
aes(x = Geographic.Area, y = avg),
color = "pink")   +
geom_line(
data = poverty_state,
aes(x = Geographic.Area, y = avg),
group = 1,
color = "green"
) +
geom_point(data = poverty_state,
aes(x = Geographic.Area, y = avg),
color = "green") +
geom_curve(
data = data.frame(
x = c(38, 31),
y = c(25, 88),
xend = c(28, 28),
yend = c(32, 75)
),
mapping = aes(
x = x,
y = y,
xend = xend,
yend = yend
),
arrow = arrow(30L, unit(0.1, "inches"),
"last", "closed"),
inherit.aes = FALSE
) +
geom_text(
data = data.frame(
x = c(28, 22),
y = c(69, 28),
label = c("Hight School Graduation Rate", "Percent Below Poverty")
),
mapping = aes(x = x, y = y, label = label),
size = 4.94,
fontface = 2,
inherit.aes = FALSE
) + theme_minimal()
combined_poverty_hs <-
left_join(hs_completed, poverty_state, by = "Geographic.Area")
combined_poverty_hs <-
rename(combined_poverty_hs, Average_HS = avg.x)
combined_poverty_hs <-
rename(combined_poverty_hs, Average_Poverty = avg.y)
p2 <- p3 <- ggplot(combined_poverty_hs) +
aes(x = Average_HS, y = Average_Poverty) +
geom_point(shape = "circle", size = 2L, colour = "#440154") +
theme_minimal()
ggExtra::ggMarginal(
p = p3,
type = 'histogram',
margins = 'both',
size = 5,
colour = 'black',
fill = '#FF7F7F'
)
ggplot(combined_poverty_hs) +
geom_point(aes(x = Average_Poverty, y = Average_HS), group = 1) +
geom_smooth(aes(x = Average_Poverty, y = Average_HS),
method = "lm",
size = 1.5) +
theme_minimal()
share_race_city$share_asian <- as.numeric(share_race_city$share_asian)
share_race_city$share_white <- as.numeric(share_race_city$share_white)
share_race_city$share_black <- as.numeric(share_race_city$share_black)
share_race_city$share_native_american <- as.numeric(share_race_city$share_native_american)
share_race_city$share_hispanic <- as.numeric(share_race_city$share_hispanic)
as_tibble(share_race_city)
summary_race_share <- share_race_city %>%
group_by(Geographic.area) %>%
summarise(across(starts_with("share"), ~ mean(.x, na.rm = TRUE)))
as_tibble(summary_race_share)
summary_race_share_long <-pivot_longer(summary_race_share, cols = c("share_white",
"share_black",
"share_native_american",
"share_asian",
"share_hispanic"), names_to = "Race",
values_to = "Share")
ggplot(summary_race_share_long) +
aes(x = Geographic.area, fill = Race, weight = Share) +
geom_bar(position = "fill") +
scale_fill_brewer(palette = "Accent", direction = 1) +
labs(
x = "State",
y = "Race",
title = "Share of Different Races",
subtitle = "As a Percentage of Total"
) +
theme_minimal() +
theme(
plot.title = element_text(size = 16L,
face = "bold",
hjust = 0.5),
plot.subtitle = element_text(size = 13L,
face = "italic",
hjust = 0.5)
)
race_fatalities <-  fatalities %>%
group_by(race) %>%
tally()
race_fatalities
ggplot(race_fatalities, aes(x = "", y = n, fill = race)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
theme_minimal()
gender_fatalities <-  fatalities %>%
group_by(gender) %>%
tally()
gender_fatalities %>%
ggplot(aes(x = "", y = n, fill = gender)) +
geom_col(color = "black") +
coord_polar(theta = "y") +
theme_minimal()
ggplot(fatalities) +
aes(x = manner_of_death, y = age, fill = gender) +
geom_boxplot() +
scale_fill_brewer(palette = "Accent", direction = -1) +
theme_minimal()
gun_fatalities <- fatalities %>%
mutate(gun = ifelse(fatalities$armed == "gun", "gun", "no-gun")) %>%
group_by(gun) %>%
tally()
as_tibble(gun_fatalities)
ggplot(gun_fatalities) +
aes(x = gun, fill = gun, weight = n) +
geom_bar() +
scale_fill_brewer(palette = "Dark2", direction = 1) +
labs(title = "Guns vs Non Gun Fatalities") +
theme_minimal() +
theme(
plot.title = element_text(size = 16L,
face = "bold",
hjust = 0.5)
)
fatalities %>%
mutate("younger" = ifelse(fatalities$age <=25,"younger", "older")) %>%
group_by(younger) %>%
count() %>%
mutate(percentage = n*100/(1905+553+77))
# percentage was not the most elegant solution, but works.
esquisse:::esquisser()
ggplot(fatalities) +
aes(x = age) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_density(fill= FALSE)
ggplot(fatalities) +
aes(x = age) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_density(fill= NULL)
ggplot(fatalities) +
aes(x = age) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_vline()
ggplot(fatalities, aes(x = age)) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_vline()
ggplot(fatalities, aes(x = age)) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_vline() +
theme_minimal()
ggplot(fatalities, aes(x = age)) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_density() +
theme_minimal()
ggplot(fatalities, aes(x = age)) +
geom_histogram(bins = 55L, fill = "#112446") +
geom_density(color = "pink") +
theme_minimal()
ggplot(fatalities, aes(x = age)) +
geom_histogram(bins = 55L, fill = "#112446") +
theme_minimal()
esquisse:::esquisser()
fatalities %>%
filter(!(race %in% "")) %>%
ggplot() +
aes(x = age) +
geom_histogram(bins = 50, fill = "#EF562D") +
theme_minimal() +
facet_wrap(vars(race), scales = "free")
fatalities %>%
group_by(signs_of_mental_illness) %>%
count()
fatalities %>%
group_by(signs_of_mental_illness) %>%
count() %>%
mutate(percentage = n*100/(1902+633))
fatalities %>%
group_by(city) %>%
count() %>% arrange(desc())
fatalities %>%
group_by(city) %>%
count() %>% arrange(desc(10))
fatalities %>%
group_by(city) %>%
count()
fatalities %>%
group_by(city) %>%
count() %>% arrange(desc(n))
fatalities %>%
group_by(city) %>%
count() %>% arrange(desc(n)) %>%
head(10)
fatalities %>%
group_by(city) %>%
count() %>% arrange(desc(n)) %>%
head(11)
fatalities %>%
group_by(city) %>%
count() %>% arrange(desc(n)) %>%
head(10)
fatalities %>%
group_by(race) %>%
count()
fatalities %>%
group_by(race) %>%
count() %>%
ggplot() +
geom_col(aes(x=race, y=n))
fatalities %>%
group_by(race) %>%
count() %>%
ggplot() +
geom_col(aes(x=race, y=n)) +
theme_minimal()
fatalities %>%
group_by(signs_of_mental_illness) %>%
count() %>%
mutate(percentage = n*100/(1902+633))
fatalities %>%
group_by(city) %>%
count() %>%
arrange(desc(n)) %>%
head(10)
setwd("~/Google Drive/Code/100_days_of_Code/Day_52")
petals <- iris
View(petals)
lm(petal, Sepal.Length ~ Sepal.Width)
lm(petals, Sepal.Length ~ Sepal.Width)
?lm
lm(petals, formula = Sepal.Length ~ Sepal.Width)
summary(lm)
linear_model <- lm(petals, formula = Sepal.Length ~ Sepal.Width)
summary(linear_model)
library(tidyverse)
View(linear_model)
summary_model <- summary(linear_model)
View(summary_model)
summary(linear_model)
summary(linear_model)
ggplot(petals) +
geom_point(aes(x= Sepal.Length, y=Sepal.Width))
ggplot(petals) +
geom_point(aes(x= Sepal.Length, y=Sepal.Width, fill= Species))
ggplot(petals) +
geom_point(aes(x= Sepal.Length, y=Sepal.Width, color= Species))
linear_model2 <- lm(petals, formula = Sepal.Length ~ Petal.Length)
summary(linear_model2)
ggplot(petals) +
geom_point(aes(x= Sepal.Length, y=Petal.Length, color= Species))
esquisse:::esquisser()
ggplot(petals) +
aes(
x = Sepal.Length,
y = Petal.Length,
colour = Species,
size = Petal.Width
) +
geom_point(shape = "square") +
geom_smooth(span = 1L) +
scale_color_brewer(palette = "Set3", direction = -1) +
labs(
x = "Sepal Length",
y = "Petal Length",
title = "Comparing the Sepal Length vs Petal Length",
subtitle = "And using the relationship between the two to predit their function",
caption = "Graphic: Karat Sidhu",
color = "Species",
size = "Petal Width"
) +
ggthemes::theme_solarized_2() +
theme(
plot.title = element_text(size = 15L,
face = "bold"),
plot.caption = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")
)
ggplot(petals) +
aes(
x = Sepal.Length,
y = Petal.Length,
colour = Species,
size = Petal.Width
) +
geom_point(shape = "square") +
geom_smooth(span = 1, color = "black") +
scale_color_brewer(palette = "Set3", direction = -1) +
labs(
x = "Sepal Length",
y = "Petal Length",
title = "Comparing the Sepal Length vs Petal Length",
subtitle = "And using the relationship between the two to predit their function",
caption = "Graphic: Karat Sidhu",
color = "Species",
size = "Petal Width"
) +
ggthemes::theme_solarized_2() +
theme(
plot.title = element_text(size = 15L,
face = "bold"),
plot.caption = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")
)
ggplot(petals) +
aes(
x = Sepal.Length,
y = Petal.Length,
colour = Species,
size = Petal.Width
) +
geom_point(shape = "square") +
geom_smooth(span = 1) +
scale_color_brewer(palette = "Set3", direction = -1) +
labs(
x = "Sepal Length",
y = "Petal Length",
title = "Comparing the Sepal Length vs Petal Length",
subtitle = "And using the relationship between the two to predit their function",
caption = "Graphic: Karat Sidhu",
color = "Species",
size = "Petal Width"
) +
ggthemes::theme_solarized_2() +
theme(
plot.title = element_text(size = 15L,
face = "bold"),
plot.caption = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")
)
ggplot(petals) +
aes(
x = Sepal.Length,
y = Petal.Length,
colour = Species,
size = Petal.Width
) +
geom_point(shape = "square") +
geom_smooth(span = 1) +
scale_color_brewer(palette = "Set3", direction = -1) +
labs(
x = "Sepal Length",
y = "Petal Length",
title = "Comparing the Sepal Length vs Petal Length",
subtitle = "And using the relationship between the two to predit their function",
caption = "Graphic: Karat Sidhu",
color = "Species",
size = "Petal Width"
) +
ggthemes::theme_solarized_2() +
theme(
plot.title = element_text(size = 20,
face = "bold"),
plot.caption = element_text(face = "bold"),
axis.title.y = element_text(face = "bold"),
axis.title.x = element_text(face = "bold")
)
